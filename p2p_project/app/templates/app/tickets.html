{% extends 'app/index.html' %}
{% load static %}

{% block content %}

<header>
    <form action="{% url 'filter' %}" method="post" enctype="multipart/form-data">
        <div class="menu">
            {% csrf_token %}
            {% for f in form %}

            <div class="select">
                {{ f }}
            </div>

            {% endfor %}
            <div class="search-button">
                <button type="submit">Search</button>
            </div>
        </div>
    </form>
</header>

{% for tick in tickets %}

<div class="deal-card">

    {% if tick.exchange_id == 1 %}
    <div class="exchange_block" style="background: #E7BB41;"></div>
    {% elif tick.exchange_id == 2 %}
    <div class="exchange_block" style="background: #17181D;"></div>
    {% else %}
    <div class="exchange_block" style="background: #4D21B3;"></div>
    {% endif %}

    <div class="title info-block">
        <span class="amount">
            <span class="bold">{{ tick.nick_name }}</span><br>
            {% if tick.exchange_id == 3 %}
            <span class="transparent">{{ tick.rate }} Like(s)</span>
            {% else %}
            <span class="transparent">{{ tick.orders }} Order(s) | {{ tick.rate }} %</span>
            {% endif %}
        </span>
    </div>

    <div class="price info-block">
        <span class="amount">
            <span class="bold">{{ tick.price }}</span> <span class="transparent">{{ tick.currency }}</span>
        </span>
    </div>

    <div class="limit info-block">
        <span class="amount">
            <span class="transparent">Available</span> <span class="bold">
                {{ tick.available }}
            </span>
            <br>
            <span class="transparent">Limits</span> <span class="bold">
                {{ tick.min_limit }} ~ {{ tick.max_limit }}
            </span>
            <span class="transparent">{{ tick.currency }}</span>
        </span>
    </div>

    <div class="payment info-block">
        <span class="tooltip amount" title="{{ tick.pay_methods }}">
            <span class="transparent">
                Payment
                <img src="{% static 'app/image/quest.png' %}" alt="quest">
            </span>
        </span>
    </div>

    <div class="button-block amount">

        {% if tick.trade_type == 'SELL' %}
        <button onclick="window.location.href='{{ tick.link }}';" style="background: #FF6666;"
                onmouseover="this.style.background = '#fc8080'"
                onmouseout="this.style.background = '#FF6666'">
            {{ tick.trade_type }} {{ tick.coin }}
        </button>

        {% else %}
        <button onclick="window.location.href='{{ tick.link }}';" style="background: #77DD77;"
                onmouseover="this.style.background = '#8de38d'"
                onmouseout="this.style.background = '#77DD77'">
            {{ tick.trade_type }} {{ tick.coin }}
        </button>

        {% endif %}
    </div>
</div>

{% endfor %}
<div class="footer">
    <div class="pagination">
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}">&#8249;</a>
        {% endif %}

        {% if page_obj.number > 3 %}
        <a href="?page=1">1</a>
        {% if page_obj.number > 4 %}
        <span class="ellipsis">...</span>
        {% endif %}
        {% endif %}

        {% for num in page_obj.paginator.page_range %}
        {% if num > page_obj.number|add:'-2' and num < page_obj.number|add:'2' %}
        {% if page_obj.number == num %}
        <span class="current-page">{{ num }}</span>
        {% else %}
        <a href="?page={{ num }}">{{ num }}</a>
        {% endif %}
        {% endif %}
        {% endfor %}

        {% if page_obj.number < page_obj.paginator.num_pages|add:'-2' %}
        {% if page_obj.number < page_obj.paginator.num_pages|add:'-3' %}
        <span class="ellipsis">...</span>
        {% endif %}
        <a href="?page={{ page_obj.paginator.num_pages }}">{{ page_obj.paginator.num_pages }}</a>
        {% endif %}

        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">&#8250;</a>
        {% endif %}
    </div>
</div>


{% endblock %}

{% block footer %}
<footer>
    <div class="container">
        <div class="author">
            <img src="{% static 'app/image/new-logo.png' %}" alt="">
            <p>&copy; 2023 p2p-collector.com. All rights reserved.</p>
        </div>
        <div class="author-links">
            <div class="github">
                <img src="{% static 'app/image/github-sign.png' %}" alt="github">
                <a href="https://github.com/galvains" target="_blank">Github</a>
            </div>
            <div class="telegram">
                <img src="{% static 'app/image/telegram.png' %}" alt="telegram">
                <a href="https://t.me/yarik03k" target="_blank">Telegram</a>
            </div>
        </div>
    </div>
</footer>
{% endblock %}
